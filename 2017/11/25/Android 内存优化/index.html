<!DOCTYPE html>
<html lang="zh-Hans">
<head>
<!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta name="format-detection" content="telephone=no">
<meta name="author" content="appzy">
<meta name="baidu-site-verification" content="s8Pe1TBqyy">



<meta name="description" content="为什么优化虽然 Java 对内存的释放有垃圾自动回收机制，但是实际开发中，不再用到的对象因为被错误引用会导致无法回收，从而造成内存泄漏，甚至内存溢出 OOM（OutOfMemory），程序崩溃。">
<meta name="keywords" content="memory">
<meta property="og:type" content="article">
<meta property="og:title" content="Android 内存优化">
<meta property="og:url" content="http://appzy.vip/2017/11/25/Android 内存优化/index.html">
<meta property="og:site_name" content="appzy">
<meta property="og:description" content="为什么优化虽然 Java 对内存的释放有垃圾自动回收机制，但是实际开发中，不再用到的对象因为被错误引用会导致无法回收，从而造成内存泄漏，甚至内存溢出 OOM（OutOfMemory），程序崩溃。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://7q5c2h.com1.z0.glb.clouddn.com/monitor-heap-dump.png">
<meta property="og:image" content="http://7q5c2h.com1.z0.glb.clouddn.com/monitor-garbage-collect.png">
<meta property="og:updated_time" content="2017-11-25T04:23:00.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android 内存优化">
<meta name="twitter:description" content="为什么优化虽然 Java 对内存的释放有垃圾自动回收机制，但是实际开发中，不再用到的对象因为被错误引用会导致无法回收，从而造成内存泄漏，甚至内存溢出 OOM（OutOfMemory），程序崩溃。">
<meta name="twitter:image" content="http://7q5c2h.com1.z0.glb.clouddn.com/monitor-heap-dump.png">

<link rel="apple-touch-icon" href="/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="appzy" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.ico">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>Android 内存优化 | appzy</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>





  <style type="text/css">
  .div_right_bottom {
  width: 200px;
  top: 50%;
  right: 0px;
  position: fixed;
  margin-top: -100px;
  _position: absolute;
}
</style>
</head></html>
<body>
<div class="div_right_bottom" style="z-index:99" align="center">
  <img src="http://appzy.vip/images/csyl.jpg" height="180px" width="180px">
  微信公众号
  </div>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">appzy</a></h1>
        </hgroup>

        
        <p class="header-subtitle">不为模糊不清的未来担忧，只为清清楚楚的现在努力。</p>
        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false">
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class="no-result">No results found <i class="fa fa-spinner fa-pulse"></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa GitHub" href="https://github.com/appzy" title="GitHub"></a>
                            
                                <a class="fa Coding" href="https://coding.net/u/appzy/project" title="Coding"></a>
                            
                                <a class="fa 简书" href="http://www.jianshu.com/users/b2d0a8ba449b/timeline" title="简书"></a>
                            
                                <a class="fa 知乎" href="https://www.zhihu.com/people/le-hu-95-55/activities" title="知乎"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa Email" href="mailto:http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=PAkNDgsKBQ4MCnxNTRJfU1E" title="Email"></a>
                            
                                <a class="fa 新浪微博" href="http://weibo.com/login.php" title="新浪微博"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AndroidPay/">AndroidPay</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Glide/">Glide</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Singleton/">Singleton</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android-面试/">android 面试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/">jQuery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/memory/">memory</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webview/">webview</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/代码混淆/">代码混淆</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/正则表达式/">正则表达式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设备信息/">设备信息</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="http://appzy.vip">appzy</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://appzy.github.io/">GitHub</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">Make progress every day and Never give up......</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">appzy</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">appzy</a></h1>
            </hgroup>
            
            <p class="header-subtitle">不为模糊不清的未来担忧，只为清清楚楚的现在努力。</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/appzy" title="GitHub"></a>
                            
                                <a class="fa Coding" target="_blank" href="https://coding.net/u/appzy/project" title="Coding"></a>
                            
                                <a class="fa 简书" target="_blank" href="http://www.jianshu.com/users/b2d0a8ba449b/timeline" title="简书"></a>
                            
                                <a class="fa 知乎" target="_blank" href="https://www.zhihu.com/people/le-hu-95-55/activities" title="知乎"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa Email" target="_blank" href="mailto:http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=PAkNDgsKBQ4MCnxNTRJfU1E" title="Email"></a>
                            
                                <a class="fa 新浪微博" target="_blank" href="http://weibo.com/login.php" title="新浪微博"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我">
</nav>
      <div class="body-wrap"><article id="post-Android 内存优化" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/11/25/Android 内存优化/" class="article-date">
      <time datetime="2017-11-25T04:23:00.000Z" itemprop="datePublished">2017-11-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        <h1 class="article-title" itemprop="name">
      Android 内存优化
    </h1>
      </header>
      
      <div class="article-info article-info-post">
        
        <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/memory/">memory</a></li></ul>
    </div>
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="为什么优化"><a href="#为什么优化" class="headerlink" title="为什么优化"></a>为什么优化</h2><p>虽然 Java 对内存的释放有垃圾自动回收机制，但是实际开发中，<br>不再用到的对象因为被错误引用会导致无法回收，从而造成内存泄漏，<br>甚至内存溢出 OOM（OutOfMemory），程序崩溃。</p>
<a id="more"></a>
<h3 id="Android-GC-原理"><a href="#Android-GC-原理" class="headerlink" title="Android GC 原理"></a>Android GC 原理</h3><p>参考：<a href="https://mp.weixin.qq.com/s/CUU3Ml394H_fkabhNNX32Q" target="_blank" rel="noopener">Android GC 原理探究</a></p>
<h3 id="Android-内存管理"><a href="#Android-内存管理" class="headerlink" title="Android 内存管理"></a>Android 内存管理</h3><p>参考：<a href="https://developer.android.google.cn/topic/performance/memory-overview" target="_blank" rel="noopener">Android 内存管理</a></p>
<h2 id="如何检测"><a href="#如何检测" class="headerlink" title="如何检测"></a>如何检测</h2><h3 id="使用-LeakCanary"><a href="#使用-LeakCanary" class="headerlink" title="使用 LeakCanary"></a>使用 LeakCanary</h3><p>Android 内存泄漏检测库：<a href="https://github.com/square/leakcanary" target="_blank" rel="noopener">https://github.com/square/leakcanary</a> ，善于使用 LeakCanary 发现内存泄漏。</p>
<h3 id="Memory-Monitor工具"><a href="#Memory-Monitor工具" class="headerlink" title="Memory Monitor工具"></a>Memory Monitor工具</h3><p>Android Studio 中的 Android Monitor ，选择其中的 Memory，跟踪整个 APP 的内存变化情况。<br>步骤如下：<br>1、与您的应用交互，在 Memory 监视器中，查看 Free 和 Alloated 内存。<br>2、点击 Dump Java Heap：<br><img src="http://7q5c2h.com1.z0.glb.clouddn.com/monitor-heap-dump.png" alt=""><br>，这个会打开 HPROF 查看器，如果没有，在 Captures 标签中，双击堆快照文件以打开 HPROF 查看器。<br>3、要引起堆分配，请与您的应用交互，然后点击触发 GC 的按钮：<br><img src="http://7q5c2h.com1.z0.glb.clouddn.com/monitor-garbage-collect.png" alt=""></p>
<h3 id="Heap-Viewer-工具"><a href="#Heap-Viewer-工具" class="headerlink" title="Heap Viewer 工具"></a>Heap Viewer 工具</h3><p>实时查看App分配的内存大小和空闲内存大小，发现 Memory Leaks 。<br>详细使用教程：<a href="https://www.kancloud.cn/digest/itfootballprefermanc/100907" target="_blank" rel="noopener">Heap Viewer工具</a></p>
<h3 id="Allocation-Tracker"><a href="#Allocation-Tracker" class="headerlink" title="Allocation Tracker"></a>Allocation Tracker</h3><p>追踪内存对象的来源。<br>详细使用教程：<a href="https://www.kancloud.cn/digest/itfootballprefermanc/100908" target="_blank" rel="noopener">Allocation Tracker(Device Monitor)</a></p>
<h2 id="优化方案"><a href="#优化方案" class="headerlink" title="优化方案"></a>优化方案</h2><h3 id="检查使用多少内存"><a href="#检查使用多少内存" class="headerlink" title="检查使用多少内存"></a>检查使用多少内存</h3><p>每个 APP 的堆（heap）内存大小有硬性限制，如果您的 APP 已达到堆内存限制，并尝试分配更多的内存，<br>系统会抛出 OutOfMemoryError 。为了避免 OOM ，您可以查询当前设备有多少堆空间，<br>可以通过调用系统 getMemoryInfo() 查询，返回 一个ActivityManager.MemoryInfo 对象，<br>它提供该设备当前存储器的状态信息，包括可用的存储器，总存储器，和低于该阈值存储器。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">private void getMemoryInfo() &#123;</span><br><span class="line">    ActivityManager activityManager = (ActivityManager) this.getSystemService(ACTIVITY_SERVICE);</span><br><span class="line">    ActivityManager.MemoryInfo memoryInfo = new ActivityManager.MemoryInfo();</span><br><span class="line">    activityManager.getMemoryInfo(memoryInfo);</span><br><span class="line">    LogUtil.d(&quot;totalMem=&quot; + memoryInfo.totalMem + &quot;,availMem=&quot; + memoryInfo.availMem);</span><br><span class="line">    if (!memoryInfo.lowMemory) &#123;</span><br><span class="line">        // 运行在低内存环境</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="当界面不可见时释放内存"><a href="#当界面不可见时释放内存" class="headerlink" title="当界面不可见时释放内存"></a>当界面不可见时释放内存</h3><p>实现 <a href="https://developer.android.google.cn/reference/android/content/ComponentCallbacks2.html" target="_blank" rel="noopener">ComponentCallbacks2</a> API 中 <a href="https://developer.android.google.cn/reference/android/content/ComponentCallbacks2#onTrimMemory(int" target="_blank" rel="noopener">onTrimMemory()</a>)，<br>当回调参数 level 为 TRIM_MEMORY_UI_HIDDEN ，是用户点击了Home键或者Back键退出应用，<br>所有UI界面被隐藏，这时候应该释放一些不可见的时候非必须的资源。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity</span><br><span class="line">    implements ComponentCallbacks2 &#123;</span><br><span class="line">    // Other activity code ...</span><br><span class="line">    /**</span><br><span class="line">     * Release memory when the UI becomes hidden or when system resources become low.</span><br><span class="line">     * @param level the memory-related event that was raised.</span><br><span class="line">     */</span><br><span class="line">    public void onTrimMemory(int level) &#123;</span><br><span class="line">        // Determine which lifecycle or system event was raised.</span><br><span class="line">        switch (level) &#123;</span><br><span class="line">            case ComponentCallbacks2.TRIM_MEMORY_UI_HIDDEN:</span><br><span class="line">                /*</span><br><span class="line">                   Release any UI objects that currently hold memory.</span><br><span class="line">                   The user interface has moved to the background.</span><br><span class="line">                */</span><br><span class="line">                break;</span><br><span class="line">            case ComponentCallbacks2.TRIM_MEMORY_RUNNING_MODERATE:</span><br><span class="line">            case ComponentCallbacks2.TRIM_MEMORY_RUNNING_LOW:</span><br><span class="line">            case ComponentCallbacks2.TRIM_MEMORY_RUNNING_CRITICAL:</span><br><span class="line">                /*</span><br><span class="line">                   Release any memory that your app doesn&apos;t need to run.</span><br><span class="line">                   The device is running low on memory while the app is running.</span><br><span class="line">                   The event raised indicates the severity of the memory-related event.</span><br><span class="line">                   If the event is TRIM_MEMORY_RUNNING_CRITICAL, then the system will</span><br><span class="line">                   begin killing background processes.</span><br><span class="line">                */</span><br><span class="line">                break;</span><br><span class="line">            case ComponentCallbacks2.TRIM_MEMORY_BACKGROUND:</span><br><span class="line">            case ComponentCallbacks2.TRIM_MEMORY_MODERATE:</span><br><span class="line">            case ComponentCallbacks2.TRIM_MEMORY_COMPLETE:</span><br><span class="line">                /*</span><br><span class="line">                   Release as much memory as the process can.</span><br><span class="line">                   The app is on the LRU list and the system is running low on memory.</span><br><span class="line">                   The event raised indicates where the app sits within the LRU list.</span><br><span class="line">                   If the event is TRIM_MEMORY_COMPLETE, the process will be one of</span><br><span class="line">                   the first to be terminated.</span><br><span class="line">                */</span><br><span class="line">                break;</span><br><span class="line">            default:</span><br><span class="line">                /*</span><br><span class="line">                  Release any non-critical data structures.</span><br><span class="line">                  The app received an unrecognized memory level value</span><br><span class="line">                  from the system. Treat this as a generic low-memory message.</span><br><span class="line">                */</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>该 onTrimMemory() 回调是在搭载Android 4.0（API级别14）加入。对于早期版本，您可以使用 onLowMemory() 回调作为旧版本的回调，这大致相当于 TRIM_MEMORY_COMPLETE事件。</p>
<h3 id="谨慎使用服务"><a href="#谨慎使用服务" class="headerlink" title="谨慎使用服务"></a>谨慎使用服务</h3><p>离开了 APP 还在运行服务是最糟糕的内存管理错误之一，当 APP 处在后台，我们应该停止服务，<br>除非它需要运行的任务。我们可以使用 <a href="https://developer.android.google.cn/topic/performance/background-optimization" target="_blank" rel="noopener">JobScheduler</a> 替代实现，<br><a href="https://developer.android.google.cn/topic/performance/background-optimization" target="_blank" rel="noopener">JobScheduler</a> 把一些不是特别紧急的任务放到更合适的时机批量处理。如果必须使用一个服务，<br>最佳方法是使用 <a href="https://developer.android.google.cn/training/run-background-service/index.html" target="_blank" rel="noopener">IntentService</a> ，限制服务寿命，所有请求处理完成后，IntentService 会自动停止。</p>
<h3 id="使用优化的数据容器"><a href="#使用优化的数据容器" class="headerlink" title="使用优化的数据容器"></a>使用优化的数据容器</h3><p>考虑使用优化过数据的容器 SparseArray / SparseBooleanArray / LongSparseArray 代替 HashMap 等传统数据结构，通用 HashMap 的实现可以说是相当低效的内存，因为它需要为每个映射一个单独的条目对象。</p>
<h3 id="避免在-Android-上使用枚举"><a href="#避免在-Android-上使用枚举" class="headerlink" title="避免在 Android 上使用枚举"></a>避免在 Android 上使用枚举</h3><p>枚举往往需要两倍多的内存，静态常量更多，我们应该严格避免在 Android 上使用枚举。</p>
<h3 id="使用-nano-protobufs-序列化数据"><a href="#使用-nano-protobufs-序列化数据" class="headerlink" title="使用 nano protobufs 序列化数据"></a>使用 nano protobufs 序列化数据</h3><p>Protocol buffers 是一个语言中立，平台中立的，可扩展的机制，由谷歌进行序列化结构化数据，类似于 XML 设计的，但是更小，更快，更简单。如果需要为您的数据序列化与协议化，建议使用 nano protobufs。</p>
<h3 id="避免内存流失"><a href="#避免内存流失" class="headerlink" title="避免内存流失"></a>避免内存流失</h3><p>内存流失可能会导致出现大量的 GC 事件，如自定义组件的 onDraw() ，避免大量创建临时对象，比如 String ，以免频繁触发 GC。GC 事件通常不影响您的 APP 的性能，然而在很短的时间段，发生许多垃圾收集事件可以快速地吃了您的帧时间，系统上时间的都花费在 GC ，就有很少时间做其他的东西像渲染或音频流。</p>
<h3 id="使用ProGuard来剔除不需要的代码"><a href="#使用ProGuard来剔除不需要的代码" class="headerlink" title="使用ProGuard来剔除不需要的代码"></a>使用ProGuard来剔除不需要的代码</h3><p>使用 ProGuard 来剔除不需要的代码，移除任何冗余的，不必要的，或臃肿的组件，资源或库完善 APP 的内存消耗。</p>
<h3 id="降低整体尺寸APK"><a href="#降低整体尺寸APK" class="headerlink" title="降低整体尺寸APK"></a>降低整体尺寸APK</h3><p>您可以通过减少 APP 的整体规模显著减少 APP 的内存使用情况。文章：<a href="http://wuxiaolong.me/2017/03/19/ReduceAPKSize/" target="_blank" rel="noopener">Android APK瘦身实践</a></p>
<h3 id="优化布局层次"><a href="#优化布局层次" class="headerlink" title="优化布局层次"></a>优化布局层次</h3><p>通过优化视图层次结构，以减少重叠的 UI 对象的数量来提高性能。文章：<a href="http://wuxiaolong.me/2017/03/26/Rendering/" target="_blank" rel="noopener">Android 渲染优化</a></p>
<h3 id="使用-Dagger-2依赖注入"><a href="#使用-Dagger-2依赖注入" class="headerlink" title="使用 Dagger 2依赖注入"></a>使用 Dagger 2依赖注入</h3><p>依赖注入框架可以简化您写的代码，并提供一个自适应环境测试和便于其他配置的更改。如果打算在您的 APP 使用依赖注入框架，可以考虑用 Dagger 2 ，Dagger 不使用反射扫描 APP 的代码，Dagger 是静态的，意味着它编译时不需要占用运行 Android 应用或内存的使用。</p>
<h3 id="请小心使用外部库"><a href="#请小心使用外部库" class="headerlink" title="请小心使用外部库"></a>请小心使用外部库</h3><p>外部库的代码往往是未针对移动环境下编写并用于工作在移动客户端上时，可能是低效的。当您决定使用外部库，您可能需要优化该库为移动设备。</p>
<h3 id="避免Bitmap浪费"><a href="#避免Bitmap浪费" class="headerlink" title="避免Bitmap浪费"></a>避免Bitmap浪费</h3><p>Bitmap是内存消耗的大头，当使用时要及时回收。另外配置：<br>inSampleSize：缩放比例，图片按需加载，避免不必要的大图载入。<br>decode format：解码格式，选择ARGB_8888/RBG_565/ARGB_4444/ALPHA_8，存在很大差异。</p>
<h3 id="Cursor关闭"><a href="#Cursor关闭" class="headerlink" title="Cursor关闭"></a>Cursor关闭</h3><p>如查询数据库的操作，使用到Cursor，也要对Cursor对象及时关闭。</p>
<h3 id="监听器的注销"><a href="#监听器的注销" class="headerlink" title="监听器的注销"></a>监听器的注销</h3><p>Android程序里面存在很多需要register与unregister的监听器，手动add的listener，需要记得及时remove这个listener。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://developer.android.google.cn/topic/performance/memory-overview" target="_blank" rel="noopener">官网Overview of Android Memory Management</a></p>
<p><a href="https://developer.android.google.cn/topic/performance/memory" target="_blank" rel="noopener">官网Manage Your App’s Memory</a></p>
<p><a href="http://hukai.me/android-performance-oom/" target="_blank" rel="noopener">Android内存优化之OOM</a></p>
      
    </div>
    
  </div>
  
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2017/11/25/Android 内存优化/">Android 内存优化</a></p>
        <p><span>文章作者:</span><a href="/" title="回到主页">appzy</a></p>
        <p><span>发布时间:</span>2017-11-25, 12:23:00</p>
        <p><span>最后更新:</span>2017-11-25, 12:23:00</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/11/25/Android 内存优化/" title="Android 内存优化">http://appzy.vip/2017/11/25/Android 内存优化/</a>
            <span class="copy-path" data-clipboard-text="原文: http://appzy.vip/2017/11/25/Android 内存优化/　　作者: appzy" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target="_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2018/02/02/DeviceInfo采集android设备信息工具/">
                    DeviceInfo采集android设备信息工具
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2017/09/20/Android代码混淆干货/">
                    Android代码混淆干货
                </a>
            </div>
        
    </nav>
  
</article>
<div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么优化"><span class="toc-number">1.</span> <span class="toc-text"><a href="#&#x4E3A;&#x4EC0;&#x4E48;&#x4F18;&#x5316;" class="headerlink" title="&#x4E3A;&#x4EC0;&#x4E48;&#x4F18;&#x5316;"></a>&#x4E3A;&#x4EC0;&#x4E48;&#x4F18;&#x5316;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Android-GC-原理"><span class="toc-number">1.1.</span> <span class="toc-text"><a href="#Android-GC-&#x539F;&#x7406;" class="headerlink" title="Android GC &#x539F;&#x7406;"></a>Android GC &#x539F;&#x7406;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Android-内存管理"><span class="toc-number">1.2.</span> <span class="toc-text"><a href="#Android-&#x5185;&#x5B58;&#x7BA1;&#x7406;" class="headerlink" title="Android &#x5185;&#x5B58;&#x7BA1;&#x7406;"></a>Android &#x5185;&#x5B58;&#x7BA1;&#x7406;</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#如何检测"><span class="toc-number">2.</span> <span class="toc-text"><a href="#&#x5982;&#x4F55;&#x68C0;&#x6D4B;" class="headerlink" title="&#x5982;&#x4F55;&#x68C0;&#x6D4B;"></a>&#x5982;&#x4F55;&#x68C0;&#x6D4B;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#使用-LeakCanary"><span class="toc-number">2.1.</span> <span class="toc-text"><a href="#&#x4F7F;&#x7528;-LeakCanary" class="headerlink" title="&#x4F7F;&#x7528; LeakCanary"></a>&#x4F7F;&#x7528; LeakCanary</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Memory-Monitor工具"><span class="toc-number">2.2.</span> <span class="toc-text"><a href="#Memory-Monitor&#x5DE5;&#x5177;" class="headerlink" title="Memory Monitor&#x5DE5;&#x5177;"></a>Memory Monitor&#x5DE5;&#x5177;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Heap-Viewer-工具"><span class="toc-number">2.3.</span> <span class="toc-text"><a href="#Heap-Viewer-&#x5DE5;&#x5177;" class="headerlink" title="Heap Viewer &#x5DE5;&#x5177;"></a>Heap Viewer &#x5DE5;&#x5177;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Allocation-Tracker"><span class="toc-number">2.4.</span> <span class="toc-text"><a href="#Allocation-Tracker" class="headerlink" title="Allocation Tracker"></a>Allocation Tracker</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#优化方案"><span class="toc-number">3.</span> <span class="toc-text"><a href="#&#x4F18;&#x5316;&#x65B9;&#x6848;" class="headerlink" title="&#x4F18;&#x5316;&#x65B9;&#x6848;"></a>&#x4F18;&#x5316;&#x65B9;&#x6848;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#检查使用多少内存"><span class="toc-number">3.1.</span> <span class="toc-text"><a href="#&#x68C0;&#x67E5;&#x4F7F;&#x7528;&#x591A;&#x5C11;&#x5185;&#x5B58;" class="headerlink" title="&#x68C0;&#x67E5;&#x4F7F;&#x7528;&#x591A;&#x5C11;&#x5185;&#x5B58;"></a>&#x68C0;&#x67E5;&#x4F7F;&#x7528;&#x591A;&#x5C11;&#x5185;&#x5B58;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#当界面不可见时释放内存"><span class="toc-number">3.2.</span> <span class="toc-text"><a href="#&#x5F53;&#x754C;&#x9762;&#x4E0D;&#x53EF;&#x89C1;&#x65F6;&#x91CA;&#x653E;&#x5185;&#x5B58;" class="headerlink" title="&#x5F53;&#x754C;&#x9762;&#x4E0D;&#x53EF;&#x89C1;&#x65F6;&#x91CA;&#x653E;&#x5185;&#x5B58;"></a>&#x5F53;&#x754C;&#x9762;&#x4E0D;&#x53EF;&#x89C1;&#x65F6;&#x91CA;&#x653E;&#x5185;&#x5B58;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#谨慎使用服务"><span class="toc-number">3.3.</span> <span class="toc-text"><a href="#&#x8C28;&#x614E;&#x4F7F;&#x7528;&#x670D;&#x52A1;" class="headerlink" title="&#x8C28;&#x614E;&#x4F7F;&#x7528;&#x670D;&#x52A1;"></a>&#x8C28;&#x614E;&#x4F7F;&#x7528;&#x670D;&#x52A1;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用优化的数据容器"><span class="toc-number">3.4.</span> <span class="toc-text"><a href="#&#x4F7F;&#x7528;&#x4F18;&#x5316;&#x7684;&#x6570;&#x636E;&#x5BB9;&#x5668;" class="headerlink" title="&#x4F7F;&#x7528;&#x4F18;&#x5316;&#x7684;&#x6570;&#x636E;&#x5BB9;&#x5668;"></a>&#x4F7F;&#x7528;&#x4F18;&#x5316;&#x7684;&#x6570;&#x636E;&#x5BB9;&#x5668;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#避免在-Android-上使用枚举"><span class="toc-number">3.5.</span> <span class="toc-text"><a href="#&#x907F;&#x514D;&#x5728;-Android-&#x4E0A;&#x4F7F;&#x7528;&#x679A;&#x4E3E;" class="headerlink" title="&#x907F;&#x514D;&#x5728; Android &#x4E0A;&#x4F7F;&#x7528;&#x679A;&#x4E3E;"></a>&#x907F;&#x514D;&#x5728; Android &#x4E0A;&#x4F7F;&#x7528;&#x679A;&#x4E3E;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用-nano-protobufs-序列化数据"><span class="toc-number">3.6.</span> <span class="toc-text"><a href="#&#x4F7F;&#x7528;-nano-protobufs-&#x5E8F;&#x5217;&#x5316;&#x6570;&#x636E;" class="headerlink" title="&#x4F7F;&#x7528; nano protobufs &#x5E8F;&#x5217;&#x5316;&#x6570;&#x636E;"></a>&#x4F7F;&#x7528; nano protobufs &#x5E8F;&#x5217;&#x5316;&#x6570;&#x636E;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#避免内存流失"><span class="toc-number">3.7.</span> <span class="toc-text"><a href="#&#x907F;&#x514D;&#x5185;&#x5B58;&#x6D41;&#x5931;" class="headerlink" title="&#x907F;&#x514D;&#x5185;&#x5B58;&#x6D41;&#x5931;"></a>&#x907F;&#x514D;&#x5185;&#x5B58;&#x6D41;&#x5931;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用ProGuard来剔除不需要的代码"><span class="toc-number">3.8.</span> <span class="toc-text"><a href="#&#x4F7F;&#x7528;ProGuard&#x6765;&#x5254;&#x9664;&#x4E0D;&#x9700;&#x8981;&#x7684;&#x4EE3;&#x7801;" class="headerlink" title="&#x4F7F;&#x7528;ProGuard&#x6765;&#x5254;&#x9664;&#x4E0D;&#x9700;&#x8981;&#x7684;&#x4EE3;&#x7801;"></a>&#x4F7F;&#x7528;ProGuard&#x6765;&#x5254;&#x9664;&#x4E0D;&#x9700;&#x8981;&#x7684;&#x4EE3;&#x7801;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#降低整体尺寸APK"><span class="toc-number">3.9.</span> <span class="toc-text"><a href="#&#x964D;&#x4F4E;&#x6574;&#x4F53;&#x5C3A;&#x5BF8;APK" class="headerlink" title="&#x964D;&#x4F4E;&#x6574;&#x4F53;&#x5C3A;&#x5BF8;APK"></a>&#x964D;&#x4F4E;&#x6574;&#x4F53;&#x5C3A;&#x5BF8;APK</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#优化布局层次"><span class="toc-number">3.10.</span> <span class="toc-text"><a href="#&#x4F18;&#x5316;&#x5E03;&#x5C40;&#x5C42;&#x6B21;" class="headerlink" title="&#x4F18;&#x5316;&#x5E03;&#x5C40;&#x5C42;&#x6B21;"></a>&#x4F18;&#x5316;&#x5E03;&#x5C40;&#x5C42;&#x6B21;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用-Dagger-2依赖注入"><span class="toc-number">3.11.</span> <span class="toc-text"><a href="#&#x4F7F;&#x7528;-Dagger-2&#x4F9D;&#x8D56;&#x6CE8;&#x5165;" class="headerlink" title="&#x4F7F;&#x7528; Dagger 2&#x4F9D;&#x8D56;&#x6CE8;&#x5165;"></a>&#x4F7F;&#x7528; Dagger 2&#x4F9D;&#x8D56;&#x6CE8;&#x5165;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#请小心使用外部库"><span class="toc-number">3.12.</span> <span class="toc-text"><a href="#&#x8BF7;&#x5C0F;&#x5FC3;&#x4F7F;&#x7528;&#x5916;&#x90E8;&#x5E93;" class="headerlink" title="&#x8BF7;&#x5C0F;&#x5FC3;&#x4F7F;&#x7528;&#x5916;&#x90E8;&#x5E93;"></a>&#x8BF7;&#x5C0F;&#x5FC3;&#x4F7F;&#x7528;&#x5916;&#x90E8;&#x5E93;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#避免Bitmap浪费"><span class="toc-number">3.13.</span> <span class="toc-text"><a href="#&#x907F;&#x514D;Bitmap&#x6D6A;&#x8D39;" class="headerlink" title="&#x907F;&#x514D;Bitmap&#x6D6A;&#x8D39;"></a>&#x907F;&#x514D;Bitmap&#x6D6A;&#x8D39;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cursor关闭"><span class="toc-number">3.14.</span> <span class="toc-text"><a href="#Cursor&#x5173;&#x95ED;" class="headerlink" title="Cursor&#x5173;&#x95ED;"></a>Cursor&#x5173;&#x95ED;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#监听器的注销"><span class="toc-number">3.15.</span> <span class="toc-text"><a href="#&#x76D1;&#x542C;&#x5668;&#x7684;&#x6CE8;&#x9500;" class="headerlink" title="&#x76D1;&#x542C;&#x5668;&#x7684;&#x6CE8;&#x9500;"></a>&#x76D1;&#x542C;&#x5668;&#x7684;&#x6CE8;&#x9500;</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-number">4.</span> <span class="toc-text"><a href="#&#x53C2;&#x8003;" class="headerlink" title="&#x53C2;&#x8003;"></a>&#x53C2;&#x8003;</span></a></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录" title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>


    <div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"Android 内存优化　| appzy　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>



    


<div class="scroll" id="post-nav-button">
        
            <a href="/2018/02/02/DeviceInfo采集android设备信息工具/" title="上一篇: DeviceInfo采集android设备信息工具">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2017/09/20/Android代码混淆干货/" title="下一篇: Android代码混淆干货">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/04/20/Glide源码分析解读-基于Glide 4.9.0/">Glide源码分析解读-基于Glide 4.9.0</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/20/jQuery夜晚天空满天星星闪烁动画/">jQuery夜晚天空满天星星闪烁动画（附源码）</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/11/Android 接入微信支付宝支付/">Android 接入微信支付宝支付</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/02/DeviceInfo采集android设备信息工具/">DeviceInfo采集android设备信息工具</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/25/Android 内存优化/">Android 内存优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/20/Android代码混淆干货/">Android代码混淆干货</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/26/webview详解和常见的问题/">webview详解和常见的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/19/Android面试总结/">Android面试总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/15/Android面试总结(问答)/">Android面试总结(问答篇)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/11/设计模式之单例模式/">设计模式之单例模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/15/可视化正则表达式/">可视化正则表达式整理</a></li></ul>


    <script>
        
    </script></div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2019 appzy
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架" rel="external nofollow">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5" rel="external nofollow">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style="display:none">
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style="display:none">
                        <span id="page-visit" title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    <script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>
<script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>



<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide()" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
